<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Charis+SIL:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <title>Luke Jianu</title>
    <link rel="stylesheet" type="text/css" href="/styles.css" />
    <link rel="stylesheet" href="/highlight/styles/default.css">
    <script src="/highlight/highlight.js"></script>
    <script>hljs.highlightAll();</script>
  </head>
  <body>
    <root><div><style>body {
          max-width: 620px;
        }</style><style>@media screen and (max-width: 620px) {
           body {
             max-width: 95%;
           }
         }</style></div><h2 id="blockchain-draft">Blockchain (Draft)</h2><p>The goal of this post is to explain what Bitcoin is and how it works.</p><h3 id="the-centralized-ledger">The Centralized Ledger</h3><p>Suppose that a group of friends exchange money frequently. Exchanging cash each time is inconvenient, so they decide to introduce a ledger, where they track the payments they each intend to make at some point in the future.</p><pre><code>Ledger

Alice pays Bob $20
Bob pays Charlie $40
Charlie pays Alice $10</code></pre><p>The ledger is publically accessible as a website, where anyone can add new entries. One clear problem is this ledger lacks authentication—there is no way to tell whether an entry was added by sender.</p><p>The solution is digital signatures. Every entry in the ledger must be signed by the sender. Additionally, every entry in the ledger must start with an index, to defend against a replay attack.</p><pre><code>Ledger

1. Alice pays Bob $20 - Signed by Alice.
2. Bob pays Charlie $40 - Signed by Bob.
3. Charlie pays Alice $10 - Signed by Charlie.</code></pre><p>At this point, now that the ledger is more or less secure, the friends agree to pay what they owe to one another and reset the ledger monthly. But, what if one of the friends doesn&rsquo;t have the money to pay?</p><p>The solution here is to change the ledger rules. When the ledger is created, each friend deposits $100 into the same pot, and lines are added to the ledger granting each friend $100. The new rule says that overspending is prohibited.</p><pre><code>Ledger

1. Alice gets $100.
2. Bob gets $100.
3. Charlie gets $100.
4. Charlie pays Alice $50 - Signed by Charlie.
5. Charlie pays Alice $60 - Signed by Charlie. &lt;- NOT ALLOWED!</code></pre><p>Notice that this ledger we&rsquo;ve created is a currency. If everyone in the world used this ledger, we wouldn&rsquo;t need cash anymore. The reason nobody would want to use this ledger is because it&rsquo;s centralized. Assuming Alice is hosting the ledger on her website, even Bob and Charlie should be complaining that Alice ultimately controls the ledger. While she can&rsquo;t create fake transactions, because of the signature system, her site could still decide to reject certain transactions—Bob and Charlie need to be careful not to upset her!</p><h3 id="the-decentralized-ledger">The Decentralized Ledger</h3><p>Bob and Charlie convince Alice to join them and create a decentralized ledger. A decentralized ledger is one where every member keeps their own copy of the ledger. In order for this system to function, every member must have the same copy at all times—they need to reach consensus. Otherwise, Alice could simultaneously tell Bob and Charlie that she&rsquo;ll pay them $100, effectively double-spending!</p><p>Put another way, members of the ledger are constantly notifying others of transactions they&rsquo;re making, but how can they agree on which transactions become part of the consensus, and in what order? An online goods seller Eve should only ship a package once all members have agreed that the transaction paying Eve X dollars is part of the ledger.</p><p>One idea is to pick the most trustworthy member and have this member processes transactions, choosing an ordering and publishing the updated ledger. Perhaps someone like Alice, who ran the old ledger. But wait&hellip; that sounds exactly like the centralized ledger from before!</p><p>Another idea is to vote, which seems wise considering that&rsquo;s how governments reach consensus. Suppose that every 10 minutes, every member proposes a new ledger, and votes based on the others ledgers they&rsquo;ve received. The ledger with the most votes is taken to be the new ledger. The problem with this approach is the way that majority is defined. Governments leverage centralization to ensure that each person votes once. There is no way to prevent a member from creating countless new identities and voting for their own ledger, resulting in a centralized ledger.</p><p>The solution to the decentralized consensus problem is strange. The solution is, in essence, to pick a random member to propose a new ledger. The genius is in how this random member is selected. At any point, all members are trying to solve a math puzzle related to the new transactions they&rsquo;d like to add to the ledger. This math puzzle is very computationally expensive. The member who solves the puzzle first publishes the new ledger, in addition to the solution to the puzzle, so that other members know they actually solved it. Of course, the network performs other checks before accepting the new ledger. Members must check that the transactions have valid signatures, check that the new transactions don&rsquo;t cause overspending, and check that the new ledger only appended to the old ledger. If the proposed new ledger is invalid, then members should ignore it, even though the proposer solved the math puzzle. Critically, it should be very difficult for one individual to solve many of these puzzles in a row—in fact, it would require them to own a large portion of the compute in the overall network.</p><h3 id="bitcoin">Bitcoin</h3><p>Bitcoin is a decentralized ledger. When a node wants to make a transaction, it broadcasts the signed transaction across the network. The job of the miner is to collect transactions into a block. A block contains a reference (hash) to the previous block, the list of new transactions, and a nonce representing the &ldquo;proof of work&rdquo;. The miner increments the nonce and hashes the entire block until it finds a hash that starts with N number of zeroes. Once it finds the nonce, it broadcasts the block across the network, which becomes the tip of the new ledger.</p><p>Nodes and miners always care about the longest chain of blocks, since that represents the ledger where that the majority of compute is going towards. A node may observe a branch in the blockchain, where it received two new blocks that both point to the same parent block. In this case, the node should wait until there is consensus. In Bitcoin, the node should wait until their transaction is &ldquo;buried&rdquo; in at least 6&ndash;7 blocks. This is because it is extremely unlikely that a minority of the compute could solve 6&ndash;7 blocks in a row.</p></root>
    <hr/>
    <footer>
      Built with <a href="https://docs.racket-lang.org/pollen/" target="_blank">Pollen</a> &
      <a href="https://racket-lang.org/" target="_blank">Racket</a>.
    </footer>
  </body>
</html>